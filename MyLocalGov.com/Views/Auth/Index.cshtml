@using Microsoft.AspNetCore.Identity
@{
    Layout = "_Layout";
    ViewData["Title"] = "Landing Page";
    ViewData["HideNavbar"] = true;
    var showForm = Context.Request.Query["showForm"].ToString();
    var email = Context.Request.Query["email"].ToString();
    var loginError = Context.Request.Query["loginError"].ToString();
    var registerError = Context.Request.Query["registerError"].ToString();
    bool formActive = !string.IsNullOrEmpty(showForm);
}

<main class="landing-page-bg" id="landingPageContainer">
    <section class="landing-page-row">
        <header class="logo-container">
            <div class="logo animate-scale-in" id="logo">
                <span class="logo-icon">üèõÔ∏è</span>
            </div>
            <h1 class="title animate-slide-up" id="mainTitle">Civic Connect</h1>
            <p class="subtitle animate-fade @(formActive ? "hidden" : "")" id="subtitle">
                Your South African municipal services portal.<br>
                <strong>Report issues ‚Ä¢ Request services ‚Ä¢ Stay informed</strong>
            </p>
            <button id="enterButton" class="btn btn-primary mt-3 animate-bounce-in @(formActive ? "hidden" : "")">
                Get Started ‚Üí
            </button>
        </header>

        <section class="form-container @(formActive ? "active" : "") animate-fade" id="formContainer">
            <form id="loginForm" class="form @(showForm == "login" ? "active" : "") animate-slide-up" method="post" action="/Account/Login">
                <div class="title">
                    Welcome,<br><span class="text-muted">login to continue</span>
                </div>
                @if (!string.IsNullOrEmpty(loginError))
                {
                    <div class="alert alert-danger" role="alert">
                        <span>@loginError</span>
                    </div>
                }
                <input type="email" name="email" placeholder="Email"
                       class="form-control"
                       value="@(showForm == "login" ? email : "")" required />
                <input type="password" name="password" placeholder="Password"
                       class="form-control" required />
                <button type="submit" class="btn btn-success">Log In</button>
                <p class="text-center">
                    <a href="#" id="showSignUp" class="switch-link">Need an account? Sign Up Here!</a>
                </p>
            </form>

            <form id="signUpForm" class="form @(showForm == "register" ? "active" : "") animate-slide-up" method="post" action="/Account/Register">
                <div class="title">
                    Welcome,<br><span class="text-muted">create an account</span>
                </div>
                @if (!string.IsNullOrEmpty(registerError))
                {
                    <div class="alert alert-danger" role="alert">
                        <span>@registerError</span>
                    </div>
                }
                <input type="text" name="firstName" placeholder="First Name"
                       class="form-control" required />
                <input type="text" name="lastName" placeholder="Last Name"
                       class="form-control" required />
                <input type="email" name="email" placeholder="Email"
                       class="form-control"
                       value="@(showForm == "register" ? email : "")" required />
                <input type="password" name="password" placeholder="Password"
                       class="form-control" required />
                <input type="password" name="confirmPassword" placeholder="Confirm Password"
                       class="form-control" required />
                <button type="submit" class="btn btn-success">Sign Up</button>
                <p class="text-center">
                    <a href="#" id="showLogin" class="switch-link">Already have an account? Log In</a>
                </p>
            </form>
        </section>
    </section>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>

@section Scripts {
<script>
    window.onPageReady(function () {
        const enterButton = document.getElementById("enterButton");
        const subtitle = document.getElementById("subtitle");
        const formContainer = document.getElementById("formContainer");
        const loginForm = document.getElementById("loginForm");
        const signUpForm = document.getElementById("signUpForm");
        const showSignUp = document.getElementById("showSignUp");
        const showLogin = document.getElementById("showLogin");

        if (formContainer.classList.contains("active")) {
            // Only run form-active animations
            subtitle?.classList.add("hidden");
            enterButton?.classList.add("hidden");
            Animations.slideLeft("#logo", 100);
            Animations.slideLeft("#mainTitle", 200);
            Animations.fadeIn("#formContainer");
            if (loginForm.classList.contains("active")) {
                Animations.fadeIn("#formContainer");
                Animations.slideUp("#loginForm", 200);
            }
            if (signUpForm.classList.contains("active")) {
                Animations.fadeIn("#formContainer");
                Animations.slideUp("#signUpForm", 200);
            }
        } else {
            // Only run landing animations
            Animations.scaleIn("#logo");
            Animations.slideUp("#mainTitle", 100);
            Animations.fadeIn("#subtitle", 200);
            Animations.bounceIn("#enterButton", 300);
            Animations.slideRight("#animationsDemoButton", 400);
        }

        if (enterButton) {
            enterButton.addEventListener("click", () => {
                subtitle.classList.add("hidden");
                formContainer.classList.add("active");
                loginForm.classList.add("active");
                signUpForm.classList.remove("active");
                enterButton.classList.add("hidden");

                // Animate logo and title moving
                Animations.slideLeft("#logo", 100);
                Animations.slideLeft("#mainTitle", 200);

                // Animate form container and login form appearing
                Animations.fadeIn("#formContainer");
                Animations.slideUp("#loginForm", 200);
            });
        }

        if (showSignUp) {
            showSignUp.addEventListener("click", (e) => {
                e.preventDefault();
                loginForm.classList.remove("active");
                signUpForm.classList.add("active");

                // Animate sign up form
                Animations.slideRight("#signUpForm");
            });
        }

        if (showLogin) {
            showLogin.addEventListener("click", (e) => {
                e.preventDefault();
                signUpForm.classList.remove("active");
                loginForm.classList.add("active");

                // Animate login form
                Animations.slideLeft("#loginForm");
            });
        }
    });
</script>
}

<link rel="stylesheet" href="/css/Home/index.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
